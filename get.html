
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Request Assistance</title>
    <link rel="stylesheet" href="style_get.css">
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY&callback=initMap" async defer></script>
</head>

<body>
    <div class="main-container centered-flex">
        <div class="form-container">
            <div class="icon fa fa-car"></div>
            <form id="help-form" class="centered-flex">
                <div class="title">Request Assistance</div>
                
                <!-- User Name -->
                <div class="field">
                    <input type="text" placeholder="Enter Your Name" id="username" required>
                    <span class="fa fa-user"></span>
                </div>
                
                <!-- Phone Number -->
                <div class="field">
                    <input type="tel" placeholder="Enter Your Phone Number" id="phone" required>
                    <span class="fa fa-phone"></span>
                </div>

                <!-- Current Location -->
                <div class="field">
                    <input type="text" placeholder="Current Location" id="location" required readonly>
                    <button type="button" id="locate-btn" class="btn-small">üìç Detect</button>
                </div>
                
                <div id="map" style="width: 100%; height: 300px; margin-top: 10px;"></div>

                <!-- Vehicle Type -->
                <div class="field">
                    <select id="vehicle" required>
                        <option value="">Select Vehicle</option>
                        <option value="Bike">Bike</option>
                        <option value="Car">Car</option>
                        <option value="Load Van">Load Van</option>
                    </select>
                </div>

                <!-- Additional Needs -->
                <div class="field">
                    <textarea id="needs" placeholder="Additional Needs (Optional)" rows="3"></textarea>
                </div>

                <!-- Upload Image -->
                <div class="field">
                    <input type="file" id="image" accept="image/*" required>
                </div>

                <div class="btn-container">
                    <input type="submit" id="request-btn" value="Request Help">
                </div>

                <div class="signup">
                    <a href="home.html">Back to Home</a>
                </div>
            </form>
        </div>
    </div>
    
    <script>
        let map;

        function initMap() {
            map = new google.maps.Map(document.getElementById("map"), {
                center: { lat: -34.397, lng: 150.644 },
                zoom: 15
            });
        }

        document.getElementById("locate-btn").addEventListener("click", function () {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function (position) {
                    const latitude = position.coords.latitude;
                    const longitude = position.coords.longitude;
                    document.getElementById("location").value = `Lat: ${latitude}, Lng: ${longitude}`;
                    
                    const userLocation = new google.maps.LatLng(latitude, longitude);
                    map.setCenter(userLocation);
                    new google.maps.Marker({ position: userLocation, map: map });
                }, function () {
                    alert("Unable to retrieve your location");
                });
            } else {
                alert("Geolocation is not supported by your browser");
            }
        });
        
        document.getElementById("help-form").addEventListener("submit", function (event) {
            event.preventDefault();
            
            const username = document.getElementById("username").value;
            const phone = document.getElementById("phone").value;
            const location = document.getElementById("location").value;
            const vehicle = document.getElementById("vehicle").value;
            const needs = document.getElementById("needs").value;
            const image = document.getElementById("image").files[0];
            
            const formData = new FormData();
            formData.append("username", username);
            formData.append("phone", phone);
            formData.append("location", location);
            formData.append("vehicle", vehicle);
            formData.append("needs", needs);
            formData.append("image", image);
            
            fetch("https://your-backend-api.com/sendRequest", {
                method: "POST",
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                alert("Request sent to the nearest mechanic!");
            })
            .catch(error => {
                console.error("Error:", error);
                alert("Failed to send request. Try again later.");
            });
        });
    </script>
</body>

</html>
